<!DOCTYPE html>
<!--[if IEMobile 7]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html
  class="no-js"
  lang="en"
><!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>Making beautiful boxplots using plotnine in Python</title>
    <meta name="author" content="Jodie Burchell" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="description" content="Making beautiful boxplots using plotnine in Python written September 06, 2020 in python,plotnine">
  <meta name="keywords" content="python, plotnine, boxplot, ggplot, matplotlib" />

    <link
      rel="canonical"
      href="https://t-redactyl.github.io/blog/2020/09/making-beautiful-boxplots-using-plotnine-in-python.html"
    />

    <link href="https://t-redactyl.github.io/favicon.png" rel="icon" />

    <link
      href="https://t-redactyl.github.io/feeds/all.atom.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Standard error Full Atom Feed"
    />
      <link
      href="https://t-redactyl.github.io/theme/css/screen.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://t-redactyl.github.io/theme/css/tomorrow.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
     <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <!-- KaTeX for math rendering -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.css"
      integrity="sha384-VEnyslhHLHiYPca9KFkBB3CMeslnM9CzwjxsEbZTeA21JBm7tdLwKoZmCt3cZTYD"
      crossorigin="anonymous"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.js"
      integrity="sha384-O4hpKqcplNCe+jLuBVEXC10Rn1QEqAmX98lKAIFBEDxZI0a+6Z2w2n8AEtQbR4CD"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/contrib/auto-render.min.js"
      integrity="sha384-IiI65aU9ZYub2MY9zhtKd1H2ps7xxf+eb2YFG9lX6uRqpXCvBTOidPRCXCrQ++Uc"
      crossorigin="anonymous"
    ></script>
   </head>
  <body>
    <a href="/" class="home-icon">
      <img src="https://t-redactyl.github.io/theme/images/home.png" />
    </a>
<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Making beautiful boxplots using plotnine in Python</h1>
        <div class="meta">
          written <time datetime="2020-09-06T00:00:00+02:00">September 06, 2020</time>
          in <span class="categories">
            <a href="https://t-redactyl.github.io/tag/python.html">python</a>,            <a href="https://t-redactyl.github.io/tag/plotnine.html">plotnine</a>          </span>
        </div>
        <p>For the past year and a half, I have been switching gradually from using <code>matplotlib</code> to create graphs in Python to <a href="https://twitter.com/HKibirige">Hassan Kibirige&#8217;s</a> wonderful port of R&#8217;s <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a>, <a href="https://plotnine.readthedocs.io/en/stable/"><code>plotnine</code></a>. When I was first starting to use this package, I found it was quite tricky to find clear instructions on how to make customisations or build some of the more specialised charts. As such, <a href="https://twitter.com/pachamaltese">Mauricio</a> and I decided to create a series of tutorials on how to build and customise a range of charts in <code>plotnine</code>, going step-by-step from a basic plot to a highly customised&nbsp;graph. </p>
<p>This week I am sharing our tutorial on how to create and customise boxplots in <code>plotnine</code>. If you enjoyed this blog post and found it useful, please consider buying our book! It contains chapters detailing how to build and customise 11 other chart types, including bar charts, line charts, scatterplots, histograms, density plots and regression plots (including all of the regression diagnostic plots available in R). Every purchase really helps us out with maintaining the&nbsp;content.</p>
<p><a href="https://leanpub.com/plotnine-guide"><img alt="plotnine book" class="banner" src="/figure/plotnine-book-banner-small.png" title="The Hitchhikers Guide to Plotnine"></a></p>
<p>With that out of the way, let&#8217;s get on with creating our boxplot in <code>plotnine</code>! In this tutorial, we will work towards creating the line plot below. We will take you from a basic line plot and explain all the customisations we add to the code&nbsp;step-by-step.</p>
<p><img src="/figure/plotnine_boxplot_final.png" title="Final boxplot" style="display: block; margin: auto;" /></p>
<p>The first step is to import all of the required packages. For this we need<code>pandas</code> and its <code>DataFrame</code> class to read in and manipulate our data, <code>plotnine</code> to get our data and create our graphs, and <code>numpy</code> to do some basic numeric calculations in our&nbsp;graphing.</p>
<pre><code class="python">import numpy as np
import pandas as pd

import plotnine

from plotnine import *
from plotnine import data
from pandas import DataFrame
</code></pre>

<p>We then need to load in the data, as&nbsp;below.</p>
<pre><code class="python">diamonds = data.diamonds
</code></pre>

<h2>Basic ggplot&nbsp;structure</h2>
<p>In order to initialise a boxplot we tell <code>ggplot</code> that <code>diamonds</code> is our data, and specify that our x-axis plots the <code>cut</code> variable and our y-axis plots the <code>price</code> variable. You may have noticed that we put our variables inside a method called <code>aes</code>. This is short for aesthetic mappings, and determines how the different variables you want to use will be mapped to parts of the graph. As you can see below, <code>ggplot</code> has mapped <code>cut</code> to the x-axis and <code>price</code> to the&nbsp;y-axis.</p>
<p>You might have also noticed that there is nothing in the plot. In order to render our data, we need to tell <code>ggplot</code> how we want to visually represent&nbsp;it.</p>
<pre><code class="python">p10 = ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_1.png" title="Boxplot 1" style="display: block; margin: auto;" /></p>
<h2>Basic&nbsp;boxplot</h2>
<p>We can do this using <code>geoms</code>. In the case of a boxplot, we use the <code>geom_boxplot()</code> geom.</p>
<pre><code class="python">p10 = ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;)) + geom_boxplot()
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_2.png" title="Boxplot 2" style="display: block; margin: auto;" /></p>
<h2>Customising axis&nbsp;labels</h2>
<p>In order to change the axis labels, we have used the <code>xlab</code> and <code>ylab</code> options. In each, we add the desired name as an&nbsp;argument.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot()
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_3.png" title="Boxplot 3" style="display: block; margin: auto;" /></p>
<p><code>ggplot</code> also allows for the use of multiline names (in both axes and titles). Here, we&#8217;ve changed the y-axis label so that it goes over two lines using the <code>\n</code> character to break the&nbsp;line.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot()
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond\n(USD)&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_4.png" title="Boxplot 4" style="display: block; margin: auto;" /></p>
<h2>Changing axis&nbsp;ticks</h2>
<p>To change the x-axis tick marks, we can use the <code>scale_x_continuous</code> option. Similarly, to change the y-axis we can use the <code>scale_y_continuous</code> option. Here we will change the y-axis to every $2500 rather than the default of $5000. We can change the breaks using the <code>breaks</code> option, which takes a list of values as an argument. You can shortcut having to type in the whole list manually using numpy&#8217;s <code>arange</code> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html">function</a> which generates a sequence from your selected start, stop and step values respectively. Note that because of Python&#8217;s indexing, you need to set the <code>stop</code> argument to be one number more than your desired&nbsp;maximum.</p>
<p>Similarly, you can use the <code>limits</code> argument to define the minimum and maximum values of your axis. We&#8217;ve also included this in our <code>scale_y_continuous</code> option, increasing the maximum value to&nbsp;$20000.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;)) + geom_boxplot()
    + xlab(&quot;Diamond cut&quot;) + ylab(&quot;Price of diamond\n(USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), limits=[0, 20000])
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_5.png" title="Boxplot 5" style="display: block; margin: auto;" /></p>
<h2>Adding a&nbsp;title</h2>
<p>To add a title, we include the option <code>ggtitle</code> and include the name of the graph as a string&nbsp;argument.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot()
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond\n(USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_6.png" title="Boxplot 6" style="display: block; margin: auto;" /></p>
<h2>Changing the colour of the&nbsp;boxes</h2>
<p>To change the line and fill colours of the box plot, we add a valid colour to the <code>colour</code> and <code>fill</code> arguments in <code>geom_boxplot()</code>. <code>plotnine</code> uses the colour palette utilised by <code>matplotlib</code>, and the full set of named colours recognised by <code>ggplot</code> is <a href="https://matplotlib.org/examples/color/named_colors.html">here</a>. Let&#8217;s try changing our box lines and fills to <code>rebeccapurple</code> and <code>lightskyblue</code> respectively.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;rebeccapurple&quot;, fill=&quot;lightskyblue&quot;)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond\n(USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_7.png" title="Boxplot 7" style="display: block; margin: auto;" /></p>
<p>If you want to go beyond the options in the list above, you can also specify exact <span class="caps">HEX</span> colours by including them as a string preceded by a hash, e.g., <code>"#FFFFFF"</code>. Below, we have called two shades of blue for the fill and lines using their <span class="caps">HEX</span>&nbsp;codes.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;#1F3552&quot;, fill=&quot;#4271AE&quot;)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond\n(USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_8.png" title="Boxplot 8" style="display: block; margin: auto;" /></p>
<p>You can also specify the degree of transparency in the box fill area using the argument <code>alpha</code> in <code>geom_boxplot()</code>. This ranges from 0 to&nbsp;1.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;#1F3552&quot;, fill=&quot;#4271AE&quot;, 
                   alpha=0.7)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond\n(USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_9.png" title="Boxplot 9" style="display: block; margin: auto;" /></p>
<p>Finally, you can change the appearance of the outliers as well, using the arguments <code>outlier.colour</code> and <code>outlier.shape</code> in <code>geom_boxplot</code> to change the colour and shape respectively. The shape arguments for <code>plotnine</code> are the same as those available in <code>matplotlib</code>, and are therefore a little more limited than those in R&#8217;s implementation of <code>ggplot2</code>. Nonetheless, there is a good range of options. The allowed arguments are <a href="https://matplotlib.org/api/markers_api.html">here</a>. Here we will make the outliers small solid circles (using <code>outlier.shape="."</code>) and make them coloured <code>steelblue</code> (using <code>outlier.colour="steelblue"</code>). </p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(
        colour=&quot;#1F3552&quot;,
        fill=&quot;#4271AE&quot;,
        alpha=0.7,
        outlier_shape=&quot;.&quot;,
        outlier_colour=&quot;steelblue&quot;,
    )
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond\n(USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_10.png" title="Boxplot 10" style="display: block; margin: auto;" /></p>
<h2>Using the white&nbsp;theme</h2>
<p>As explained in the previous chapters, we can also change the overall look of the plot using themes. We&#8217;ll start using a simple theme customisation by adding <code>theme_bw()</code>.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(
        colour=&quot;#1F3552&quot;,
        fill=&quot;#4271AE&quot;,
        alpha=0.7,
        outlier_shape=&quot;.&quot;,
        outlier_colour=&quot;steelblue&quot;,
    )
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond\n(USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme_bw()
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_11.png" title="Boxplot 11" style="display: block; margin: auto;" /></p>
<h2>Creating an <span class="caps">XKCD</span> style&nbsp;chart</h2>
<p>Of course, you may want to create your own themes as well. <code>ggplot</code> allows for a very high degree of customisation, including allowing you to use imported fonts. <code>plotnine</code> already has a <code>theme_xkcd()</code> implementation, but we&#8217;ve instead created one from scratch to demonstrate how to use imported fonts and some of the other options in <code>theme</code> to tweak the overall look of the&nbsp;graph.</p>
<p>In order to create this chart, you first need to download the <span class="caps">XKCD</span> font, which Randall Munroe has kindly provided <a href="xkcd.com/1350/xkcd-Regular.otf">here</a>. Once you have it, you can load it into Python using the <code>matplotlib.font_manager</code> class.</p>
<pre><code class="python">import matplotlib.font_manager as fm

fpath = &quot;path/to/file/xkcd-Regular.otf&quot;
</code></pre>

<p>As this is an imported font, we can&#8217;t change its size directly within the graph. Instead, we need to alter our imported font objects to change the size. As we want a different font size for the title and the body, we will create 2 different font objects, <code>title_text</code> and <code>body_set</code>.</p>
<p>We can then call methods on these objects (the list of available methods is <a href="https://matplotlib.org/api/font_manager_api.html">here</a>). For the title, we&#8217;ll change the font to size 18 and make it bold using the <code>set_size()</code> and <code>set_weight</code> methods. Similarly, we&#8217;ll change the body text to size&nbsp;12.</p>
<pre><code class="python"># Create font objects
title_text = fm.FontProperties(fname=fpath)
body_text = fm.FontProperties(fname=fpath)

# Alter size and weight of font objects
title_text.set_size(18)
title_text.set_weight(&quot;bold&quot;)

body_text.set_size(12)
</code></pre>

<p>In order to get the plot to look more like the <span class="caps">XKCD</span> artstyle, we&#8217;ll make a few more changes. We can alter the values of <code>axis_line_x</code> and <code>axis_line_y</code> to change the thickness of the axis lines. We can also get rid of the boxes around the legend by setting the argument of <code>legend_key</code> to <code>element_blank()</code>. We can remove the grid line by changing the value of four parameters: <code>panel_grid_major</code>, <code>panel_grid_minor</code>, <code>panel_border</code> and <code>panel_background</code>. To use the <span class="caps">XKCD</span> font that we just imported, we need to change the values of both <code>plot_title</code> and <code>text</code>. Finally, to change the colour of the text to black (from its default grey), we change the values of <code>axis_text_x</code> and <code>axis_text_y</code>.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;black&quot;, fill=&quot;#56B4E9&quot;)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme(
        axis_line_x=element_line(size=2, colour=&quot;black&quot;),
        axis_line_y=element_line(size=2, colour=&quot;black&quot;),
        panel_grid_major=element_blank(),
        panel_grid_minor=element_blank(),
        panel_border=element_blank(),
        panel_background=element_blank(),
        plot_title=element_text(fontproperties=title_text),
        text=element_text(fontproperties=body_text),
        axis_text_x=element_text(colour=&quot;black&quot;),
        axis_text_y=element_text(colour=&quot;black&quot;),
    )
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_12.png" title="Boxplot 12" style="display: block; margin: auto;" /></p>
<h2>Using the ‘Five Thirty Eight’&nbsp;theme</h2>
<p>There are a wider range of pre-built themes available as part of the <code>ggplot</code> package (more information on these <a href="http://plotnine.readthedocs.io/en/stable/api.html#themes">here</a>). Below we&#8217;ve applied <code>theme_538()</code>, which approximates graphs in the nice FiveThirtyEight
website. As you can see, we&#8217;ve used the commercially available fonts <a href="https://commercialtype.com/catalog/atlas/atlas_grotesk">‘Atlas Grotesk’</a> and <a href="https://www.myfonts.com/fonts/tipografiaramis/decima-mono-pro/">‘Decima Mono Pro’</a> in <code>axis_title</code>, <code>plot_title</code> and <code>text</code>. This is just to make the plots exactly like those on the site, and is entirely&nbsp;optional.</p>
<pre><code class="python">agm = &quot;path/to/file/AtlasGrotesk-Medium.otf&quot;
agr = &quot;path/to/file/AtlasGrotesk-Regular.otf&quot;
dp = &quot;path/to/file/DecimaMonoPro.otf&quot;

# Create font objects
title_text = fm.FontProperties(fname=agm)
axis_text = fm.FontProperties(fname=agr)
body_text = fm.FontProperties(fname=dp)

# Alter size and weight of font objects
title_text.set_size(16)
axis_text.set_size(12)
body_text.set_size(10)
</code></pre>

<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;#1F3552&quot;, fill=&quot;#4271AE&quot;)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme_538()
    + theme(
        axis_title=element_text(fontproperties=axis_text),
        plot_title=element_text(fontproperties=title_text),
        text=element_text(fontproperties=body_text),
    )
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_13.png" title="Boxplot 12" style="display: block; margin: auto;" /></p>
<h2>Creating your own&nbsp;theme</h2>
<p>Now that we&#8217;ve explored some of the options available in plot customisation, we can now build our own completely customised graph. Changing the <code>size</code> and <code>colour</code> arguments of <code>axis_line</code> allows us to thicken the lines and change their colour to black. Similarly, changing the colour argument passed to <code>panel_grid_major</code> means that all of our major grid lines are now light grey. We removed the minor grid lines and background by changing the arguments of <code>panel_grid_minor</code>, <code>panel_border</code> and <code>panel_background</code>, and finally, we&#8217;ve changed the font using the standard font&nbsp;Tahoma.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;#1F3552&quot;, fill=&quot;#4271AE&quot;)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme(
        axis_line=element_line(size=1, colour=&quot;black&quot;),
        panel_grid_major=element_line(colour=&quot;#d3d3d3&quot;),
        panel_grid_minor=element_blank(),
        panel_border=element_blank(),
        panel_background=element_blank(),
        plot_title=element_text(size=15, family=&quot;Tahoma&quot;, 
                                face=&quot;bold&quot;),
        text=element_text(family=&quot;Tahoma&quot;, size=11),
        axis_text_x=element_text(colour=&quot;black&quot;, size=10),
        axis_text_y=element_text(colour=&quot;black&quot;, size=10),
    )
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_14.png" title="Boxplot 13" style="display: block; margin: auto;" /></p>
<h2>Boxplot&nbsp;extras</h2>
<p>An extra feature you can add to boxplots is to overlay all of the points for that group on each boxplot in order to get an idea of the sample size of the group. This can be achieved using by adding the <code>geom_jitter()</code> option. As <code>diamonds</code> is a large dataset, we&#8217;ll first take a small sample to illustrate&nbsp;this.</p>
<pre><code class="python">diamonds_sample = diamonds.sample(1000)
</code></pre>

<pre><code class="python">p10 = (
    ggplot(diamonds_sample, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;#1F3552&quot;, fill=&quot;#4271AE&quot;)
    + geom_jitter()
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme(
        axis_line=element_line(size=1, colour=&quot;black&quot;),
        panel_grid_major=element_line(colour=&quot;#d3d3d3&quot;),
        panel_grid_minor=element_blank(),
        panel_border=element_blank(),
        panel_background=element_blank(),
        plot_title=element_text(size=15, family=&quot;Tahoma&quot;, 
                                face=&quot;bold&quot;),
        text=element_text(family=&quot;Tahoma&quot;, size=11),
        axis_text_x=element_text(colour=&quot;black&quot;, size=10),
        axis_text_y=element_text(colour=&quot;black&quot;, size=10),
    )
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_15.png" title="Boxplot 14" style="display: block; margin: auto;" /></p>
<p>We can see that the <code>Fair</code> group has a smaller sample than the other categories, indicating that it may not give as reliable information as the other cut&nbsp;types.</p>
<p>Another thing you can do with your boxplot is add a notch to the box where the median sits to give a clearer visual indication of how the data are distributed within the <span class="caps">IQR</span>. You achieve this by adding the argument <code>notch=True</code> to the <code>geom_boxplot()</code> geom.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;#1F3552&quot;, fill=&quot;#4271AE&quot;, 
                   notch=True)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme(
        axis_line=element_line(size=1, colour=&quot;black&quot;),
        panel_grid_major=element_line(colour=&quot;#d3d3d3&quot;),
        panel_grid_minor=element_blank(),
        panel_border=element_blank(),
        panel_background=element_blank(),
        plot_title=element_text(size=15, family=&quot;Tahoma&quot;, 
                                face=&quot;bold&quot;),
        text=element_text(family=&quot;Tahoma&quot;, size=11),
        axis_text_x=element_text(colour=&quot;black&quot;, size=10),
        axis_text_y=element_text(colour=&quot;black&quot;, size=10),
    )
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_16.png" title="Boxplot 15" style="display: block; margin: auto;" /></p>
<h2>Grouping by another&nbsp;variable</h2>
<p>You can also easily group boxplots by the levels of another variable. There are two options, in separate (panel) plots, or in the same&nbsp;plot.</p>
<p>We first need to do a little data wrangling. To create our grouping variable, we&#8217;ll median-split <code>carat</code> so that this is categorical, and made it into a new labelled factor variable called <code>carat_c</code>.</p>
<p>In order to produce a panel plot by this categorical carat variable, we add the <code>facet_grid(".~carat_c")</code> option to the plot. Note that unlike in R&#8217;s <code>ggplot</code>, you need to include the arguments in <code>facet_grid</code> in quote&nbsp;marks.</p>
<pre><code class="python">diamonds[&quot;carat_c&quot;] = pd.qcut(
    diamonds[&quot;carat&quot;], 2, labels=[&quot;Lower carat&quot;, &quot;Higher carat&quot;]
)
</code></pre>

<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;))
    + geom_boxplot(colour=&quot;#1F3552&quot;, fill=&quot;#4271AE&quot;)
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme(
        axis_line=element_line(size=1, colour=&quot;black&quot;),
        panel_grid_major=element_line(colour=&quot;#d3d3d3&quot;),
        panel_grid_minor=element_blank(),
        panel_border=element_blank(),
        panel_background=element_blank(),
        plot_title=element_text(size=15, family=&quot;Tahoma&quot;, 
                                face=&quot;bold&quot;),
        text=element_text(family=&quot;Tahoma&quot;, size=11),
        axis_text_x=element_text(colour=&quot;black&quot;, size=8),
        axis_text_y=element_text(colour=&quot;black&quot;, size=10),
    )
    + facet_grid(&quot;. ~ carat_c&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_17.png" title="Boxplot 16" style="display: block; margin: auto;" /></p>
<p>In order to plot the two <code>carat</code> levels in the same plot, we need to add a couple of things. Firstly, in the <code>ggplot</code> function, we add a <code>fill=carat_c</code> argument to <code>aes</code>. Secondly, we change the manual colours using the schemes from <a href="http://colorbrewer2.org/">ColorBrewer</a>. Here we have used the <code>scale_fill_brewer</code> option with the quantitative scale <code>Accent</code>. More information on using <code>scale_colour_brewer</code> is <a href="http://plotnine.readthedocs.io/en/stable/generated/plotnine.scales.scale_color_brewer.html#plotnine.scales.scale_color_brewer">here</a>. </p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;, fill=&quot;carat_c&quot;))
    + geom_boxplot()
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme(
        legend_direction=&quot;horizontal&quot;,
        legend_box_spacing=0.4,
        axis_line=element_line(size=1, colour=&quot;black&quot;),
        panel_grid_major=element_line(colour=&quot;#d3d3d3&quot;),
        panel_grid_minor=element_blank(),
        panel_border=element_blank(),
        panel_background=element_blank(),
        plot_title=element_text(size=15, family=&quot;Tahoma&quot;, 
                                face=&quot;bold&quot;),
        text=element_text(family=&quot;Tahoma&quot;, size=11),
        axis_text_x=element_text(colour=&quot;black&quot;, size=10),
        axis_text_y=element_text(colour=&quot;black&quot;, size=10),
    )
    + scale_fill_brewer(type=&quot;qual&quot;, palette=&quot;Accent&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_18.png" title="Boxplot 17" style="display: block; margin: auto;" /></p>
<h2>Formatting the&nbsp;legend</h2>
<p>Finally, we can format the legend. Firstly, we can change the position by adding the <code>legend_position="bottom"</code> argument to the <code>theme</code> option, which moves the legend under the plot. We can change the orientation of the legend to horizontal by then adding <code>legend_direction="horizontal"</code> to <code>theme</code>. We can also centre the legend by adding <code>legend_title_align="center"</code>. We can adjust the legend position using <code>legend_box_spacing=0.4</code>. We can get rid of the grey background behind the legend keys using <code>legend_key=element_blank()</code>. Lastly, we can fix the title by adding the <code>name="Diamond carat"</code> argument to the <code>scale_fill_brewer</code> option.</p>
<pre><code class="python">p10 = (
    ggplot(diamonds, aes(&quot;cut&quot;, &quot;price&quot;, fill=&quot;carat_c&quot;))
    + geom_boxplot()
    + xlab(&quot;Diamond cut&quot;)
    + ylab(&quot;Price of diamond (USD)&quot;)
    + scale_y_continuous(breaks=np.arange(0, 20001, 2500), 
                         limits=[0, 20000])
    + ggtitle(&quot;Price of diamonds by cut&quot;)
    + theme(
        legend_position=&quot;bottom&quot;,
        legend_direction=&quot;horizontal&quot;,
        legend_title_align=&quot;center&quot;,
        legend_box_spacing=0.4,
        legend_key=element_blank(),
        axis_line=element_line(size=1, colour=&quot;black&quot;),
        panel_grid_major=element_line(colour=&quot;#d3d3d3&quot;),
        panel_grid_minor=element_blank(),
        panel_border=element_blank(),
        panel_background=element_blank(),
        plot_title=element_text(size=15, family=&quot;Tahoma&quot;, 
                                face=&quot;bold&quot;),
        text=element_text(family=&quot;Tahoma&quot;, size=11),
        axis_text_x=element_text(colour=&quot;black&quot;, size=10),
        axis_text_y=element_text(colour=&quot;black&quot;, size=10),
    )
    + scale_fill_brewer(type=&quot;qual&quot;, palette=&quot;Accent&quot;, 
                        name=&quot;Diamond carat&quot;)
)
p10
</code></pre>

<p><img src="/figure/plotnine_boxplot_19.png" title="Boxplot 18" style="display: block; margin: auto;" /></p>
<p>And with that, we have recreated the plot at the beginning of this blog post! I hope you found this helped you get your feet wet with <code>plotnine</code> and see the potential you have to create plots as beautiful as those from <code>ggplot</code>.</p>
        <hr class="divider-short"/>
        <!-- Disqus goes here -->
        <!-- <section>
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite">Disqus goes here</div>
        </section>
        -->
      </div>
    </div>
  </div>
</article>
    <footer id="footer" class="her-row">
      <div class="container">
        <div class="row">
          <div class="col-md-1">
            <a href="/"><h4>Home</h4></a>
          </div>

          <div class="col-md-2">
            <div class="social-icon-list">
              <a href="https://twitter.com/t_redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_31_twitter.png"
              /></a>
               <a href="https://github.com/t-redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_21_github.png"
              /></a>
              </div>
          </div>
          <div class="pull-right">
            <h4>
              Powered by <a href="http://blog.getpelican.com/">Pelican</a>.
              Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.
              Title picture by
              <a
                href="https://pixabay.com/en/brandenburg-gate-berlin-landmark-2010656/"
                >Couleur via Pixabay</a
              >.
            </h4>
          </div>
        </div>
      </div>
    </footer>

    <!-- KaTeX rendering -->
    <script>
      renderMathInElement(document.body);
    </script>

 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66946155-1', 'auto');
  ga('send', 'pageview');

</script>    </body>
</html>