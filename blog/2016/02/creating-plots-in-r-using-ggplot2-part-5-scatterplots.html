<!DOCTYPE html>
<!--[if IEMobile 7]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html
  class="no-js"
  lang="en"
><!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>Creating plots in R using ggplot2 - part 5: scatterplots</title>
    <meta name="author" content="Jodie Burchell" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="description" content="Creating plots in R using ggplot2 - part 5: scatterplots written February 04, 2016 in r,ggplot2,r graphing tutorials">
  <meta name="keywords" content="rlanguage, ggplot2, data visualisation" />

    <link
      rel="canonical"
      href="https://t-redactyl.github.io/blog/2016/02/creating-plots-in-r-using-ggplot2-part-5-scatterplots.html"
    />

    <link href="https://t-redactyl.github.io/favicon.png" rel="icon" />

    <link
      href="https://t-redactyl.github.io/feeds/all.atom.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Standard error Full Atom Feed"
    />
      <link
      href="https://t-redactyl.github.io/theme/css/screen.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://t-redactyl.github.io/theme/css/tomorrow.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
     <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <!-- KaTeX for math rendering -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.css"
      integrity="sha384-VEnyslhHLHiYPca9KFkBB3CMeslnM9CzwjxsEbZTeA21JBm7tdLwKoZmCt3cZTYD"
      crossorigin="anonymous"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.js"
      integrity="sha384-O4hpKqcplNCe+jLuBVEXC10Rn1QEqAmX98lKAIFBEDxZI0a+6Z2w2n8AEtQbR4CD"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/contrib/auto-render.min.js"
      integrity="sha384-IiI65aU9ZYub2MY9zhtKd1H2ps7xxf+eb2YFG9lX6uRqpXCvBTOidPRCXCrQ++Uc"
      crossorigin="anonymous"
    ></script>
   </head>
  <body>
    <a href="/" class="home-icon">
      <img src="https://t-redactyl.github.io/theme/images/home.png" />
    </a>
<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Creating plots in R using ggplot2 - part 5: scatterplots</h1>
        <div class="meta">
          written <time datetime="2016-02-04T00:00:00+01:00">February 04, 2016</time>
          in <span class="categories">
            <a href="https://t-redactyl.github.io/tag/r.html">r</a>,            <a href="https://t-redactyl.github.io/tag/ggplot2.html">ggplot2</a>,            <a href="https://t-redactyl.github.io/tag/r-graphing-tutorials.html">r graphing tutorials</a>          </span>
        </div>
        <p>This is the fifth tutorial in a series on using <code>ggplot2</code> I am creating with <a href="http://pachamaltese.github.io/">Mauricio Vargas Sepúlveda</a>. In this tutorial we will demonstrate some of the many options the <code>ggplot2</code> package has for creating and customising scatterplots. We will use R&#8217;s <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/airquality.html">airquality dataset</a> in the <code>datasets</code> package. In order to reduce the complexity of these data a little, we will only be looking at the final three months in the dataset (July, August and&nbsp;September).</p>
<p>If you enjoyed this blog post and found it useful, please consider buying our book! It contains chapters detailing how to build and customise all 11 chart types published on the blog, as well as <span class="caps">LOWESS</span> charts. The book is also actively maintained (unlike the series on the blog) and contains up-to-date <code>ggplot</code> and tidyverse code, and every purchase really helps us out with keeping up with new&nbsp;content.</p>
<p><a href="https://leanpub.com/ggplot-guide"><img alt="ggplot2 book" class="banner" src="/figure/ggplot-book-banner-small.png" title="The Hitchhikers Guide to ggplot2"></a></p>
<p>In this tutorial, we will work towards creating the scatterplot below. We will take you from a basic scatterplot and explain all the customisations we add to the code&nbsp;step-by-step.</p>
<p><img src="/figure/scatter_finalgraph-1.png" title="plot of chunk scatter_finalgraph" alt="plot of chunk scatter_finalgraph" style="display: block; margin: auto;" /></p>
<p>The first thing to do is load in the data, as&nbsp;below:</p>
<div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggthemes</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">extrafont</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="n">airquality</span><span class="p">)</span>
</pre></div>


<p>We will then trim the data down to the final three months and turn the <code>Month</code> variable into a labelled factor variable. We end up with a new dataset called <code>aq_trim</code>.</p>
<div class="highlight"><pre><span></span><span class="n">aq_trim</span> <span class="o">&lt;-</span> <span class="n">airquality</span><span class="nf">[which</span><span class="p">(</span><span class="n">airquality</span><span class="o">$</span><span class="n">Month</span> <span class="o">==</span> <span class="m">7</span> <span class="o">|</span>
                            <span class="n">airquality</span><span class="o">$</span><span class="n">Month</span> <span class="o">==</span> <span class="m">8</span> <span class="o">|</span>
                            <span class="n">airquality</span><span class="o">$</span><span class="n">Month</span> <span class="o">==</span> <span class="m">9</span><span class="p">),</span> <span class="n">]</span>
<span class="n">aq_trim</span><span class="o">$</span><span class="n">Month</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">aq_trim</span><span class="o">$</span><span class="n">Month</span><span class="p">,</span>
                        <span class="n">labels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;July&quot;</span><span class="p">,</span> <span class="s">&quot;August&quot;</span><span class="p">,</span> <span class="s">&quot;September&quot;</span><span class="p">))</span>
</pre></div>


<h3>Basic&nbsp;scatterplot</h3>
<p>In order to initialise a scatterplot we tell ggplot that <code>aq_trim</code> is our data, and specify that our x-axis plots the <code>Day</code> variable and our y-axis plots the <code>Ozone</code> variable. We then instruct ggplot to render this as a scatterplot by adding the <code>geom_point()</code> option.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">()</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter1-1.png" title="plot of chunk scatter1" alt="plot of chunk scatter1" style="display: block; margin: auto;" /></p>
<h3>Changing the shape of the data&nbsp;points</h3>
<p>Perhaps we want the data points to be a different shape than a solid circle. We can change these by adding the <code>shape</code> argument to <code>geom_point</code>. An explanation of the allowed arguments for shape are described in <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/shape">this article</a>. In this case, we will use shape 21, which is a circle that allows different colours for the outline and&nbsp;fill.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">))</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">)</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter2-1.png" title="plot of chunk scatter2" alt="plot of chunk scatter2" style="display: block; margin: auto;" /></p>
<h3>Adjusting the axis&nbsp;scales</h3>
<p>To change the x-axis tick marks, we use the <code>scale_x_continuous</code> option. Similarly, to change the y-axis we use the <code>scale_y_continuous</code> option. Here we will change the x-axis to every 5 days, rather than 10, and change the range from 1 to 31 (as 0 is not a valid value for this&nbsp;variable).</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="n">p5</span> <span class="o">+</span> <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter3-1.png" title="plot of chunk scatter3" alt="plot of chunk scatter3" style="display: block; margin: auto;" /></p>
<h3>Adjusting axis labels <span class="amp">&amp;</span> adding&nbsp;title</h3>
<p>To add a title, we include the option <code>ggtitle</code> and include the name of the graph as a string argument. To change the axis names we add <code>x</code> and <code>y</code> arguments to the <code>labs</code> command.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="n">p5</span> <span class="o">+</span> <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
            <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">)</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter4-1.png" title="plot of chunk scatter4" alt="plot of chunk scatter4" style="display: block; margin: auto;" /></p>
<h3>Adjusting the colour&nbsp;palette</h3>
<p>There are a few options for adjusting the colour. The most simple is to make every point one fixed colour. You can reference colours by name, with the full list of colours recognised by R <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">here</a>. Let&#8217;s try making the outline <code>mediumvioletred</code> and the fill <code>springgreen</code>.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;mediumvioletred&quot;</span><span class="p">,</span>
                   <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;springgreen&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter5-1.png" title="plot of chunk scatter5" alt="plot of chunk scatter5" style="display: block; margin: auto;" /></p>
<p>You can change the colours using specific <span class="caps">HEX</span> codes instead. Here we have made the outline #000000 (black) and the fill &#8220;#40b8d0 (vivid&nbsp;cyan).</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;#000000&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;#40b8d0&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter6-1.png" title="plot of chunk scatter6" alt="plot of chunk scatter6" style="display: block; margin: auto;" /></p>
<p>You can also change the colour of the data points according to the levels of another variable. This can be done either as a continuous gradient, or as a levels of a factor variable. Let&#8217;s change the colour by the values of&nbsp;temperature:</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter7-1.png" title="plot of chunk scatter7" alt="plot of chunk scatter7" style="display: block; margin: auto;" /></p>
<p>We can change the gradient&#8217;s colours by adding the <code>scale_fill_continuous</code> option. The <code>low</code> and <code>high</code> arguments specify the range of colours the gradient should transition&nbsp;between.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span>  <span class="n">p5</span> <span class="o">+</span> <span class="nf">scale_fill_continuous</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="s">&quot;plum1&quot;</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="s">&quot;purple4&quot;</span><span class="p">)</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter8-1.png" title="plot of chunk scatter8" alt="plot of chunk scatter8" style="display: block; margin: auto;" /></p>
<p>We can see that higher temperatures seem to have higher ozone&nbsp;levels.</p>
<p>Let&#8217;s now change the colours of the data points by a factor variable, <code>Month</code>.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Month</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter9-1.png" title="plot of chunk scatter9" alt="plot of chunk scatter9" style="display: block; margin: auto;" /></p>
<p>Again, we can change the colours of these data points, this time using <code>scale_fill_manual</code>.</p>
<div class="highlight"><pre><span></span><span class="n">fill</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;steelblue&quot;</span><span class="p">,</span> <span class="s">&quot;yellowgreen&quot;</span><span class="p">,</span> <span class="s">&quot;violetred1&quot;</span><span class="p">)</span>

<span class="n">p5</span> <span class="o">&lt;-</span> <span class="n">p5</span> <span class="o">+</span> <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">fill</span><span class="p">)</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter10-1.png" title="plot of chunk scatter10" alt="plot of chunk scatter10" style="display: block; margin: auto;" /></p>
<h3>Adjusting legend&nbsp;position</h3>
<p>To adjust the position of the legend from the default spot of right of the graph, we add the <code>theme</code> option and specify the <code>legend.position = "bottom"</code> argument. We can also change the legend shape using the <code>legend.direction = "horizontal"</code> argument.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="n">p5</span> <span class="o">+</span> <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">legend.direction</span> <span class="o">=</span> <span class="s">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter12-1.png" title="plot of chunk scatter12" alt="plot of chunk scatter12" style="display: block; margin: auto;" /></p>
<h3>Using the white&nbsp;theme</h3>
<p>As explained in the previous posts, we can also change the overall look of the plot using themes. We&#8217;ll start using a simple theme customisation by adding <code>theme_bw()</code> after <code>ggplot()</code>. As you can see, we can further tweak the graph using the <code>theme</code> option, which we&#8217;ve used so far to change the&nbsp;legend.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Month</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">()</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;Months&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">fill</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_size</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">legend.direction</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter14-1.png" title="plot of chunk scatter14" alt="plot of chunk scatter14" style="display: block; margin: auto;" /></p>
<h3>Creating an <span class="caps">XKCD</span> style&nbsp;chart</h3>
<p>Of course, you may want to create your own themes as well. <code>ggplot2</code> allows for a very high degree of customisation, including allowing you to use imported fonts. Below is an example of a theme Mauricio was able to create which mimics the visual style of <a href="http://xkcd.com/"><span class="caps">XKCD</span></a>. In order to create this chart, you first need to import the <span class="caps">XKCD</span> font, install it on your machine and load it into R using the <code>extrafont</code> package.
These instructions are taken from <a href="https://www.google.com.au/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0ahUKEwiWzafchdPJAhVBpJQKHe_LDT8QFggbMAA&amp;url=https%3A%2F%2Fcran.r-project.org%2Fweb%2Fpackages%2Fxkcd%2Fvignettes%2Fxkcd-intro.pdf&amp;usg=AFQjCNE-KciGY14e-Q1buYIVmTFC0ht__Q&amp;sig2=DZUwkvIHwfNWtTtkcz94jg">here</a>:</p>
<div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">extrafont</span><span class="p">)</span>

<span class="nf">download.file</span><span class="p">(</span><span class="s">&quot;http://simonsoftware.se/other/xkcd.ttf&quot;</span><span class="p">,</span>
              <span class="n">dest</span><span class="o">=</span><span class="s">&quot;xkcd.ttf&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&quot;wb&quot;</span><span class="p">)</span>
<span class="nf">system</span><span class="p">(</span><span class="s">&quot;mkdir ~/.fonts&quot;</span><span class="p">)</span>
<span class="nf">system</span><span class="p">(</span><span class="s">&quot;cp xkcd.ttf  ~/.fonts&quot;</span><span class="p">)</span>
<span class="nf">font_import</span><span class="p">(</span><span class="n">paths</span> <span class="o">=</span> <span class="s">&quot;~/.fonts&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s">&quot;[X/x]kcd&quot;</span><span class="p">)</span>
<span class="nf">fonts</span><span class="p">()</span>
<span class="nf">loadfonts</span><span class="p">()</span>
</pre></div>


<p>You can then create your&nbsp;graph:</p>
<div class="highlight"><pre><span></span><span class="n">fill</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;#56B4E9&quot;</span><span class="p">,</span> <span class="s">&quot;#F0E442&quot;</span><span class="p">,</span> <span class="s">&quot;violetred1&quot;</span><span class="p">)</span>

<span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Month</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;Months&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">fill</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_size</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">legend.direction</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span>
              <span class="n">axis.line</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.major</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.grid.minor</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.border</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&quot;xkcd-Regular&quot;</span><span class="p">),</span>
              <span class="n">text</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&quot;xkcd-Regular&quot;</span><span class="p">),</span>
              <span class="n">axis.text.x</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span>
              <span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter15-1.png" title="plot of chunk scatter15" alt="plot of chunk scatter15" style="display: block; margin: auto;" /></p>
<h3>Using &#8216;The Economist&#8217;&nbsp;theme</h3>
<p>There are a wider range of pre-built themes available as part of the <code>ggthemes</code> package (more information on these <a href="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html">here</a>). Below we&#8217;ve applied <code>theme_economist()</code>, which approximates graphs in the Economist&nbsp;magazine.</p>
<div class="highlight"><pre><span></span><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Month</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">theme_economist</span><span class="p">()</span> <span class="o">+</span>
        <span class="nf">scale_fill_economist</span><span class="p">()</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;Months&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_size</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">legend.direction</span> <span class="o">=</span> <span class="s">&quot;horizontal&quot;</span><span class="p">,</span>
              <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&quot;Tahoma&quot;</span><span class="p">),</span>
              <span class="n">text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="s">&quot;Tahoma&quot;</span><span class="p">),</span>
              <span class="n">axis.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">legend.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">),</span>
              <span class="n">legend.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span> <span class="o">=</span> <span class="s">&quot;bold&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter16-1.png" title="plot of chunk scatter16" alt="plot of chunk scatter16" style="display: block; margin: auto;" /></p>
<h3>Creating your own&nbsp;theme</h3>
<p>As before, you can modify your plots a lot as <code>ggplot2</code> allows many customisations. Here we present our original result shown at the top of&nbsp;page.</p>
<div class="highlight"><pre><span></span><span class="n">fill</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;steelblue&quot;</span><span class="p">,</span> <span class="s">&quot;yellowgreen&quot;</span><span class="p">,</span> <span class="s">&quot;violetred1&quot;</span><span class="p">)</span>

<span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">aq_trim</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Day</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ozone</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Month</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Air Quality in New York by Day&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Day of the month&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;Months&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_size</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">fill</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">legend.direction</span> <span class="o">=</span> <span class="s">&quot;horizontal&quot;</span><span class="p">,</span>
              <span class="n">axis.line</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.major</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;#d3d3d3&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.minor</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.border</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span> <span class="n">panel.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">14</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="s">&quot;Tahoma&quot;</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">&quot;bold&quot;</span><span class="p">),</span>
              <span class="n">text</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&quot;Tahoma&quot;</span><span class="p">),</span>
              <span class="n">axis.text.x</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">),</span>
              <span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">))</span>
<span class="n">p5</span>
</pre></div>


<p><img src="/figure/scatter17-1.png" title="plot of chunk scatter17" alt="plot of chunk scatter17" style="display: block; margin: auto;" /></p>
        <hr class="divider-short"/>
        <!-- Disqus goes here -->
        <!-- <section>
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite">Disqus goes here</div>
        </section>
        -->
      </div>
    </div>
  </div>
</article>
    <footer id="footer" class="her-row">
      <div class="container">
        <div class="row">
          <div class="col-md-1">
            <a href="/"><h4>Home</h4></a>
          </div>

          <div class="col-md-2">
            <div class="social-icon-list">
              <a href="https://twitter.com/t_redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_31_twitter.png"
              /></a>
               <a href="https://github.com/t-redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_21_github.png"
              /></a>
              </div>
          </div>
          <div class="pull-right">
            <h4>
              Powered by <a href="http://blog.getpelican.com/">Pelican</a>.
              Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.
              Title picture by
              <a
                href="https://pixabay.com/en/brandenburg-gate-berlin-landmark-2010656/"
                >Couleur via Pixabay</a
              >.
            </h4>
          </div>
        </div>
      </div>
    </footer>

    <!-- KaTeX rendering -->
    <script>
      renderMathInElement(document.body);
    </script>

 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66946155-1', 'auto');
  ga('send', 'pageview');

</script>    </body>
</html>