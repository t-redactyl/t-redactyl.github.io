<!DOCTYPE html>
<!--[if IEMobile 7]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html
  class="no-js"
  lang="en"
><!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>Creating plots in R using ggplot2 - part 7: histograms</title>
    <meta name="author" content="Jodie Burchell" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="description" content="Creating plots in R using ggplot2 - part 7: histograms written February 28, 2016 in r,ggplot2,r graphing tutorials">
  <meta name="keywords" content="rlanguage, ggplot2, data visualisation" />

    <link
      rel="canonical"
      href="https://t-redactyl.github.io/blog/2016/02/creating-plots-in-r-using-ggplot2-part-7-histograms.html"
    />

    <link href="https://t-redactyl.github.io/favicon.png" rel="icon" />

    <link
      href="https://t-redactyl.github.io/feeds/all.atom.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Standard error Full Atom Feed"
    />
      <link
      href="https://t-redactyl.github.io/theme/css/screen.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://t-redactyl.github.io/theme/css/tomorrow.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
     <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <!-- KaTeX for math rendering -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.css"
      integrity="sha384-VEnyslhHLHiYPca9KFkBB3CMeslnM9CzwjxsEbZTeA21JBm7tdLwKoZmCt3cZTYD"
      crossorigin="anonymous"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.js"
      integrity="sha384-O4hpKqcplNCe+jLuBVEXC10Rn1QEqAmX98lKAIFBEDxZI0a+6Z2w2n8AEtQbR4CD"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/contrib/auto-render.min.js"
      integrity="sha384-IiI65aU9ZYub2MY9zhtKd1H2ps7xxf+eb2YFG9lX6uRqpXCvBTOidPRCXCrQ++Uc"
      crossorigin="anonymous"
    ></script>
   </head>
  <body>
    <a href="/" class="home-icon">
      <img src="https://t-redactyl.github.io/theme/images/home.png" />
    </a>
<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Creating plots in R using ggplot2 - part 7: histograms</h1>
        <div class="meta">
          written <time datetime="2016-02-28T00:00:00+01:00">February 28, 2016</time>
          in <span class="categories">
            <a href="https://t-redactyl.github.io/tag/r.html">r</a>,            <a href="https://t-redactyl.github.io/tag/ggplot2.html">ggplot2</a>,            <a href="https://t-redactyl.github.io/tag/r-graphing-tutorials.html">r graphing tutorials</a>          </span>
        </div>
        <p>This is the seventh tutorial in a series on using <code>ggplot2</code> I am creating with <a href="http://pachamaltese.github.io/">Mauricio Vargas Sepúlveda</a>. In this tutorial we will demonstrate some of the many options the <code>ggplot2</code> package has for creating and customising histograms. We will use R&#8217;s <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/airquality.html">airquality dataset</a> in the <code>datasets</code> package.</p>
<p>If you enjoyed this blog post and found it useful, please consider buying our book! It contains chapters detailing how to build and customise all 11 chart types published on the blog, as well as <span class="caps">LOWESS</span> charts. The book is also actively maintained (unlike the series on the blog) and contains up-to-date <code>ggplot</code> and tidyverse code, and every purchase really helps us out with keeping up with new&nbsp;content.</p>
<p><a href="https://leanpub.com/ggplot-guide"><img alt="ggplot2 book" class="banner" src="/figure/ggplot-book-banner-small.png" title="The Hitchhikers Guide to ggplot2"></a></p>
<p>The first thing to do is load in the data, as&nbsp;below:</p>
<pre><code class="r">rm(list = ls())
library(datasets)
library(ggplot2)

data(airquality)
</code></pre>

<p>In this tutorial, we will work towards creating the histogram below. We will take you from a basic histogram and explain all the customisations we add to the code&nbsp;step-by-step.</p>
<p><img src="/figure/histogram_final-1.png" title="plot of chunk histogram_final" alt="plot of chunk histogram_final" style="display: block; margin: auto;" /></p>
<h3>Basic&nbsp;histogram</h3>
<p>In order to initialise a plot we tell ggplot that <code>airquality</code> is our data, and specify that our x axis plots the <code>Ozone</code> variable. We then instruct ggplot to render this as a histogram by adding the <code>geom_histogram()</code> option.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram()
p7
</code></pre>

<p><img src="/figure/histogram_1-1.png" title="plot of chunk histogram_1" alt="plot of chunk histogram_1" style="display: block; margin: auto;" /></p>
<h3>Adding a normal density&nbsp;curve</h3>
<p>We can overlay a normal density function curve on top of our histogram to see how closely (or not) it fits a normal distribution. In this case, we can see it deviates from a normal distribution, showing marked positive skew. In order to overlay the function curve, we add the option <code>stat_function(fun = dnorm)</code>, and specify the shape using the <code>mean = mean(airquality$Ozone)</code> and <code>sd = sd(airquality$Ozone)</code> arguments. If you have missing data like we did, make sure you pass the <code>na.rm = TRUE</code> argument to the mean and sd parameters. Finally, you can change the colour using the <code>colour = "red"</code> argument. We will discuss how to customise colours further&nbsp;below.</p>
<p>One further change we must make to display the normal curve correctly is adding <code>aes(y = ..density..)</code> to the <code>geom_histogram</code> option. Note that the normal density curve will not work if you are using the frequency rather than the density, which we are changing in our next&nbsp;step.  </p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..density..)) +
        stat_function(fun = dnorm, colour = &quot;red&quot;,
                      arg = list(mean = mean(airquality$Ozone, na.rm = TRUE),
                                 sd = sd(airquality$Ozone, na.rm = TRUE)))
p7
</code></pre>

<p><img src="/figure/histogram_2-1.png" title="plot of chunk histogram_2" alt="plot of chunk histogram_2" style="display: block; margin: auto;" /></p>
<h3>Changing from density to&nbsp;frequency</h3>
<p>Let&#8217;s go back to the basic plot and lose the function curve. To change the y-axis from density to frequency, we add the <code>aes(y = ..count..)</code> option to <code>geom_histogram</code>.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..))
p7
</code></pre>

<p><img src="/figure/histogram_3-1.png" title="plot of chunk histogram_3" alt="plot of chunk histogram_3" style="display: block; margin: auto;" /></p>
<h3>Adjusting&nbsp;binwidth</h3>
<p>To change the binwidth, we add a <code>binwidth</code> argument to <code>geom_histogram</code>. In this case, we will make binwidth 5 units of the <code>Ozone</code> variable.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5)
p7
</code></pre>

<p><img src="/figure/histogram_4-1.png" title="plot of chunk histogram_4" alt="plot of chunk histogram_4" style="display: block; margin: auto;" /></p>
<h3>Customising axis&nbsp;labels</h3>
<p>In order to change the axis labels, we have a couple of options. In this case, we have used the <code>scale_x_continuous</code> and <code>scale_y_continuous</code> options, as these have further customisation options for the axes we will use below. In each, we add the desired name to the <code>name</code> argument as a&nbsp;string.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5) +
        scale_x_continuous(name = &quot;Mean ozone in parts per billion&quot;) +
        scale_y_continuous(name = &quot;Count&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_5-1.png" title="plot of chunk histogram_5" alt="plot of chunk histogram_5" style="display: block; margin: auto;" /></p>
<p>ggplot also allows for the use of multiline names (in both axes and titles). Here, we&#8217;ve changed the x-axis label so that it goes over two lines using the <code>\n</code> character to break the&nbsp;line.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;) +
        scale_y_continuous(name = &quot;Count&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_6-1.png" title="plot of chunk histogram_6" alt="plot of chunk histogram_6" style="display: block; margin: auto;" /></p>
<h3>Changing axis&nbsp;ticks</h3>
<p>The next thing we will change is the axis ticks. Let&#8217;s make the x-axis ticks appear at every 25 units rather than 50 using the <code>breaks = seq(0, 175, 25)</code> argument in <code>scale_x_continuous</code>. (The <code>seq</code> function is a base R function that indicates the start and endpoints and the units to increment by respectively. See <code>help(seq)</code> for more information.) We ensure that the x-axis begins and ends where we want by also adding the argument <code>limits = c(0, 175)</code> to <code>scale_x_continuous</code>.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_7-1.png" title="plot of chunk histogram_7" alt="plot of chunk histogram_7" style="display: block; margin: auto;" /></p>
<h3>Adding a&nbsp;title</h3>
<p>To add a title, we include the option <code>ggtitle</code> and include the name of the graph as a string&nbsp;argument.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_8-1.png" title="plot of chunk histogram_8" alt="plot of chunk histogram_8" style="display: block; margin: auto;" /></p>
<h3>Changing the colour of the&nbsp;bars</h3>
<p>To change the line and fill colours of the bars, we add a valid colour to the <code>colour</code> and <code>fill</code> arguments in <code>geom_histogram</code> (note that I assigned these colours to variables outside of the plot to make it easier to change them). A list of valid colours is <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">here</a>.</p>
<pre><code class="r">barfill &lt;- &quot;gold1&quot;
barlines &lt;- &quot;goldenrod2&quot;

p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5,
                       colour = barlines, fill = barfill) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_9-1.png" title="plot of chunk histogram_9" alt="plot of chunk histogram_9" style="display: block; margin: auto;" /></p>
<p>If you want to go beyond the options in the list above, you can also specify exact <span class="caps">HEX</span> colours by including them as a string preceded by a hash, e.g., &#8220;#<span class="caps">FFFFFF</span>&#8221;. Below, we have called two shades of blue for the fill and lines using their <span class="caps">HEX</span>&nbsp;codes.</p>
<pre><code class="r">barfill &lt;- &quot;#4271AE&quot;
barlines &lt;- &quot;#1F3552&quot;

p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5,
                       colour = barlines, fill = barfill) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_10-1.png" title="plot of chunk histogram_10" alt="plot of chunk histogram_10" style="display: block; margin: auto;" /></p>
<p>You can also add a gradient to your colour scheme that varies according to the frequency of the values. Below is the default gradient colour scheme. In order to do this, you can see we have changed the <code>aes(y = ..count..)</code> argument in <code>geom_histogram</code> to <code>aes(fill = ..count..)</code>.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(fill = ..count..), binwidth = 5) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_11-1.png" title="plot of chunk histogram_11" alt="plot of chunk histogram_11" style="display: block; margin: auto;" /></p>
<p>You can customise the gradient by changing the anchoring colours for high and low. To do so, we have added the option <code>scale_fill_gradient</code> to the plot with the arguments <code>Count</code> (the name of the legend), <code>low</code> (the colour for the least frequent values) and <code>high</code> (the colour for the most frequent&nbsp;values).</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(fill = ..count..), binwidth = 5) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        scale_fill_gradient(&quot;Count&quot;, low = &quot;blue&quot;, high = &quot;red&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_12-1.png" title="plot of chunk histogram_12" alt="plot of chunk histogram_12" style="display: block; margin: auto;" /></p>
<h3>Using the white&nbsp;theme</h3>
<p>As explained in the previous posts, we can also change the overall look of the plot using themes. We&#8217;ll start using a simple theme customisation by adding <code>theme_bw()</code> after <code>ggplot()</code>. As you can see, we can further tweak the graph using the <code>theme</code> option, which we&#8217;ve used so far to change the&nbsp;legend.</p>
<pre><code class="r">barfill &lt;- &quot;#4271AE&quot;
barlines &lt;- &quot;#1F3552&quot;

p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5,
                       colour = barlines, fill = barfill) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme_bw()
p7
</code></pre>

<p><img src="/figure/histogram_13-1.png" title="plot of chunk histogram_13" alt="plot of chunk histogram_13" style="display: block; margin: auto;" /></p>
<h3>Creating an <span class="caps">XKCD</span> style&nbsp;chart</h3>
<p>Of course, you may want to create your own themes as well. <code>ggplot2</code> allows for a very high degree of customisation, including allowing you to use imported fonts. Below is an example of a theme Mauricio was able to create which mimics the visual style of <a href="http://xkcd.com/"><span class="caps">XKCD</span></a>. In order to create this chart, you first need to import the <span class="caps">XKCD</span> font, install it on your machine and load it into R using the <code>extrafont</code> package.
These instructions are taken from <a href="https://www.google.com.au/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0ahUKEwiWzafchdPJAhVBpJQKHe_LDT8QFggbMAA&amp;url=https%3A%2F%2Fcran.r-project.org%2Fweb%2Fpackages%2Fxkcd%2Fvignettes%2Fxkcd-intro.pdf&amp;usg=AFQjCNE-KciGY14e-Q1buYIVmTFC0ht__Q&amp;sig2=DZUwkvIHwfNWtTtkcz94jg">here</a>:</p>
<pre><code class="r">library(extrafont)

download.file(&quot;http://simonsoftware.se/other/xkcd.ttf&quot;,
              dest=&quot;xkcd.ttf&quot;, mode=&quot;wb&quot;)
system(&quot;mkdir ~/.fonts&quot;)
system(&quot;cp xkcd.ttf  ~/.fonts&quot;)
font_import(paths = &quot;~/.fonts&quot;, pattern=&quot;[X/x]kcd&quot;)
fonts()
loadfonts()
</code></pre>

<p>You can then create your&nbsp;graph:</p>
<pre><code class="r">p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 10,
                       colour = &quot;black&quot;, fill = &quot;#56B4E9&quot;) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme(axis.line = element_line(size=1, colour = &quot;black&quot;),
              panel.grid.major = element_blank(),
              panel.grid.minor = element_blank(),
              panel.border = element_blank(),
              panel.background = element_blank(),
              plot.title=element_text(size = 20, family=&quot;xkcd-Regular&quot;),
              text=element_text(size = 16, family=&quot;xkcd-Regular&quot;),
              axis.text.x=element_text(colour=&quot;black&quot;, size = 12),
              axis.text.y=element_text(colour=&quot;black&quot;, size = 12))
p7
</code></pre>

<p><img src="/figure/histogram_14-1.png" title="plot of chunk histogram_14" alt="plot of chunk histogram_14" style="display: block; margin: auto;" /></p>
<h3>Using &#8216;The Economist&#8217;&nbsp;theme</h3>
<p>There are a wider range of pre-built themes available as part of the <code>ggthemes</code> package (more information on these <a href="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html">here</a>). Below we&#8217;ve applied <code>theme_economist()</code>, which approximates graphs in the Economist&nbsp;magazine.</p>
<pre><code class="r">library(ggthemes)

barfill &lt;- &quot;#4271AE&quot;
barlines &lt;- &quot;#1F3552&quot;

p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5,
                   colour = barlines, fill = barfill) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                              breaks = seq(0, 175, 25),
                              limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme_economist() +
        theme(legend.position = &quot;bottom&quot;, legend.direction = &quot;horizontal&quot;,
              legend.box = &quot;horizontal&quot;,
              legend.key.size = unit(1, &quot;cm&quot;),
              plot.title = element_text(family=&quot;Tahoma&quot;),
              text = element_text(family = &quot;Tahoma&quot;),
              axis.title = element_text(size = 12),
              legend.text = element_text(size = 9),
              legend.title=element_text(face = &quot;bold&quot;, size = 9))
p7
</code></pre>

<p><img src="/figure/histogram_15-1.png" title="plot of chunk histogram_15" alt="plot of chunk histogram_15" style="display: block; margin: auto;" /></p>
<h3>Creating your own&nbsp;theme</h3>
<p>As before, you can modify your plots a lot as <code>ggplot2</code> allows many customisations. Here is a custom plot where we have modified the axes, background and&nbsp;font.</p>
<pre><code class="r">library(grid)

barfill &lt;- &quot;#4271AE&quot;
barlines &lt;- &quot;#1F3552&quot;

p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5,
                       colour = barlines, fill = barfill) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme_bw() +
        theme(axis.line = element_line(size=1, colour = &quot;black&quot;),
              panel.grid.major = element_line(colour = &quot;#d3d3d3&quot;),
              panel.grid.minor = element_blank(),
              panel.border = element_blank(), panel.background = element_blank(),
              plot.title = element_text(size = 14, family = &quot;Tahoma&quot;, face = &quot;bold&quot;),
              text=element_text(family=&quot;Tahoma&quot;),
              axis.text.x=element_text(colour=&quot;black&quot;, size = 9),
              axis.text.y=element_text(colour=&quot;black&quot;, size = 9))
p7
</code></pre>

<p><img src="/figure/histogram_16-1.png" title="plot of chunk histogram_16" alt="plot of chunk histogram_16" style="display: block; margin: auto;" /></p>
<h3>Adding&nbsp;lines</h3>
<p>Let&#8217;s say that we want to add a cutoff value to the chart (75 parts of ozone per billion). We add the <code>geom_vline</code> option to the chart, and specify where it goes on the x-axis using the <code>xintercept</code> argument. We can customise how it looks using the <code>colour</code> and <code>linetype</code> arguments in <code>geom_vline</code>. (In the the same way, horizontal lines can be added using the <code>geom_hline</code>.)</p>
<pre><code class="r">barfill &lt;- &quot;#4271AE&quot;
barlines &lt;- &quot;#1F3552&quot;

p7 &lt;- ggplot(airquality, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 5,
                       colour = barlines, fill = barfill) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme_bw() +
        theme(axis.line = element_line(size=1, colour = &quot;black&quot;),
              panel.grid.major = element_line(colour = &quot;#d3d3d3&quot;),
              panel.grid.minor = element_blank(),
              panel.border = element_blank(), panel.background = element_blank(),
              plot.title = element_text(size = 14, family = &quot;Tahoma&quot;, face = &quot;bold&quot;),
              text=element_text(family=&quot;Tahoma&quot;),
              axis.text.x=element_text(colour=&quot;black&quot;, size = 9),
              axis.text.y=element_text(colour=&quot;black&quot;, size = 9)) +
        geom_vline(xintercept = 75, size = 1, colour = &quot;#FF3721&quot;,
                   linetype = &quot;dashed&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_17-1.png" title="plot of chunk histogram_17" alt="plot of chunk histogram_17" style="display: block; margin: auto;" /></p>
<h3>Multiple&nbsp;histograms</h3>
<p>You can also easily create multiple histograms by the levels of another variable. There are two options, in separate (panel) plots, or in the same&nbsp;plot.</p>
<p>We first need to do a little data wrangling. In order to make the graphs a bit clearer, we&#8217;ve kept only months &#8220;5&#8221; (May) and &#8220;7&#8221; (July) in a new dataset <code>airquality_trimmed</code>. We also need to convert this variable into either a character or factor variable. We have created a new factor variable <code>Month.f</code>.</p>
<p>In order to produce a panel plot by month, we add the <code>facet_grid(. ~ Month.f)</code> option to the plot. The additional <code>scale = free</code> argument in <code>facet_grid</code> means that the y-axes of each plot do not need to be the&nbsp;same.</p>
<pre><code class="r">airquality_trimmed &lt;- airquality[which(airquality$Month == 5 |
                                       airquality$Month == 7), ]
airquality_trimmed$Month.f &lt;- factor(airquality_trimmed$Month,
                                     labels = c(&quot;May&quot;, &quot;July&quot;))

p7 &lt;- ggplot(airquality_trimmed, aes(x = Ozone)) +
        geom_histogram(aes(y = ..count..), binwidth = 10,
                       colour = barlines, fill = barfill) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme_bw() +
        theme(axis.line = element_line(size=1, colour = &quot;black&quot;),
              panel.grid.major = element_line(colour = &quot;#d3d3d3&quot;),
              panel.grid.minor = element_blank(),
              panel.border = element_blank(), panel.background = element_blank(),
              plot.title = element_text(size = 14, family = &quot;Tahoma&quot;, face = &quot;bold&quot;),
              text=element_text(family=&quot;Tahoma&quot;),
              axis.text.x=element_text(colour=&quot;black&quot;, size = 9),
              axis.text.y=element_text(colour=&quot;black&quot;, size = 9)) +
        facet_grid(. ~ Month.f, scales = &quot;free&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_18-1.png" title="plot of chunk histogram_18" alt="plot of chunk histogram_18" style="display: block; margin: auto;" /></p>
<p>In order to plot the two months in the same plot, we add several things. Firstly, in the <code>ggplot</code> function, we add a <code>fill = Month.f</code> argument to <code>aes</code>. Secondly, in order to more clearly see the graph, we add two arguments to the <code>geom_histogram</code> option, <code>position = "identity"</code> and <code>alpha = 0.6</code>. This controls the position and transparency of the curves respectively. Finally, you can customise the colours of the histograms by adding the <code>scale_fill_brewer</code> to the plot from the <code>RColorBrewer</code> package. <a href="http://moderndata.plot.ly/create-colorful-graphs-in-r-with-rcolorbrewer-and-plotly/">This</a> blog post describes the available&nbsp;packages.</p>
<pre><code class="r">library(RColorBrewer)

p7 &lt;- ggplot(airquality_trimmed, aes(x = Ozone, fill = Month.f)) +
        geom_histogram(aes(y = ..count..), binwidth = 10,
                       position=&quot;identity&quot;, alpha=0.6) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                           breaks = seq(0, 175, 25),
                           limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme_bw() +
        theme(axis.line = element_line(size=1, colour = &quot;black&quot;),
              panel.grid.major = element_line(colour = &quot;#d3d3d3&quot;),
              panel.grid.minor = element_blank(),
              panel.border = element_blank(), panel.background = element_blank(),
              plot.title = element_text(size = 14, family = &quot;Tahoma&quot;, face = &quot;bold&quot;),
              text=element_text(family=&quot;Tahoma&quot;),
              axis.text.x=element_text(colour=&quot;black&quot;, size = 9),
              axis.text.y=element_text(colour=&quot;black&quot;, size = 9)) +
        scale_fill_brewer(palette=&quot;Accent&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_19-1.png" title="plot of chunk histogram_19" alt="plot of chunk histogram_19" style="display: block; margin: auto;" /></p>
<h3>Formatting the&nbsp;legend</h3>
<p>Finally, we can format the legend. Firstly, we can change the position by adding the <code>legend.position = "bottom"</code> argument to the <code>theme</code> option, which moves the legend under the plot. Secondly, we can fix the title by adding the <code>labs(fill="Month")</code> option to the plot. We now have our final&nbsp;histogram.</p>
<pre><code class="r">p7 &lt;- ggplot(airquality_trimmed, aes(x = Ozone, fill = Month.f)) +
        geom_histogram(aes(y = ..count..), binwidth = 10,
                   position=&quot;identity&quot;, alpha=0.6) +
        scale_x_continuous(name = &quot;Mean ozone in\nparts per billion&quot;,
                              breaks = seq(0, 175, 25),
                              limits=c(0, 175)) +
        scale_y_continuous(name = &quot;Count&quot;) +
        ggtitle(&quot;Frequency histogram of mean ozone&quot;) +
        theme_bw() +
        theme(axis.line = element_line(size=1, colour = &quot;black&quot;),
              panel.grid.major = element_line(colour = &quot;#d3d3d3&quot;),
              panel.grid.minor = element_blank(),
              panel.border = element_blank(), panel.background = element_blank(),
              plot.title = element_text(size = 14, family = &quot;Tahoma&quot;, face = &quot;bold&quot;),
              text=element_text(family=&quot;Tahoma&quot;),
              axis.text.x=element_text(colour=&quot;black&quot;, size = 9),
              axis.text.y=element_text(colour=&quot;black&quot;, size = 9),
              legend.position = &quot;bottom&quot;, legend.position = &quot;horizontal&quot;) +
        scale_fill_brewer(palette=&quot;Accent&quot;) +
        labs(fill=&quot;Month&quot;)
p7
</code></pre>

<p><img src="/figure/histogram_20-1.png" title="plot of chunk histogram_20" alt="plot of chunk histogram_20" style="display: block; margin: auto;" /></p>
        <hr class="divider-short"/>
        <!-- Disqus goes here -->
        <!-- <section>
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite">Disqus goes here</div>
        </section>
        -->
      </div>
    </div>
  </div>
</article>
    <footer id="footer" class="her-row">
      <div class="container">
        <div class="row">
          <div class="col-md-1">
            <a href="/"><h4>Home</h4></a>
          </div>

          <div class="col-md-2">
            <div class="social-icon-list">
              <a href="https://twitter.com/t_redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_31_twitter.png"
              /></a>
               <a href="https://github.com/t-redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_21_github.png"
              /></a>
              </div>
          </div>
          <div class="pull-right">
            <h4>
              Powered by <a href="http://blog.getpelican.com/">Pelican</a>.
              Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.
              Title picture by
              <a
                href="https://pixabay.com/en/brandenburg-gate-berlin-landmark-2010656/"
                >Couleur via Pixabay</a
              >.
            </h4>
          </div>
        </div>
      </div>
    </footer>

    <!-- KaTeX rendering -->
    <script>
      renderMathInElement(document.body);
    </script>

 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66946155-1', 'auto');
  ga('send', 'pageview');

</script>    </body>
</html>