<!DOCTYPE html>
<!--[if IEMobile 7]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html
  class="no-js"
  lang="en"
><!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>Creating plots in R using ggplot2 - part 9: function plots</title>
    <meta name="author" content="Jodie Burchell" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="description" content="Creating plots in R using ggplot2 - part 9: function plots written March 28, 2016 in r,ggplot2,r graphing tutorials">
  <meta name="keywords" content="rlanguage, ggplot2, data visualisation" />

    <link
      rel="canonical"
      href="https://t-redactyl.github.io/blog/2016/03/creating-plots-in-r-using-ggplot2-part-9-function-plots.html"
    />

    <link href="https://t-redactyl.github.io/favicon.png" rel="icon" />

    <link
      href="https://t-redactyl.github.io/feeds/all.atom.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Standard error Full Atom Feed"
    />
      <link
      href="https://t-redactyl.github.io/theme/css/screen.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://t-redactyl.github.io/theme/css/tomorrow.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
     <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <!-- KaTeX for math rendering -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.css"
      integrity="sha384-VEnyslhHLHiYPca9KFkBB3CMeslnM9CzwjxsEbZTeA21JBm7tdLwKoZmCt3cZTYD"
      crossorigin="anonymous"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.js"
      integrity="sha384-O4hpKqcplNCe+jLuBVEXC10Rn1QEqAmX98lKAIFBEDxZI0a+6Z2w2n8AEtQbR4CD"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/contrib/auto-render.min.js"
      integrity="sha384-IiI65aU9ZYub2MY9zhtKd1H2ps7xxf+eb2YFG9lX6uRqpXCvBTOidPRCXCrQ++Uc"
      crossorigin="anonymous"
    ></script>
   </head>
  <body>
    <a href="/" class="home-icon">
      <img src="https://t-redactyl.github.io/theme/images/home.png" />
    </a>
<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Creating plots in R using ggplot2 - part 9: function plots</h1>
        <div class="meta">
          written <time datetime="2016-03-28T00:00:00+02:00">March 28, 2016</time>
          in <span class="categories">
            <a href="https://t-redactyl.github.io/tag/r.html">r</a>,            <a href="https://t-redactyl.github.io/tag/ggplot2.html">ggplot2</a>,            <a href="https://t-redactyl.github.io/tag/r-graphing-tutorials.html">r graphing tutorials</a>          </span>
        </div>
        <p>This is the ninth tutorial in a series on using <code>ggplot2</code> I am creating with <a href="http://pachamaltese.github.io/">Mauricio Vargas Sepúlveda</a>. In this tutorial we will demonstrate some of the many options the <code>ggplot2</code> package has for plotting and customising&nbsp;functions.</p>
<p><a href="https://twitter.com/pachamaltese">Mauricio</a> and <a href="https://twitter.com/t_redactyl">I</a> have also published these graphing posts as a <a href="https://leanpub.com/hitchhikers_ggplot2">book on Leanpub</a>. We tend to put any changes or updates to the code in the book before these blog posts, so please check it out if you have any issues with the code examples in this post; otherwise feel free to contact us with any&nbsp;questions!</p>
<p>In this tutorial, we will work towards creating the function plot below. We will take you from a basic function plot and explain all the customisations we add to the code&nbsp;step-by-step.</p>
<p><img src="/figure/function_final-1.png" title="plot of chunk function_final" alt="plot of chunk function_final" style="display: block; margin: auto;" /></p>
<h3>Basic normal&nbsp;curve</h3>
<p>In order to create a normal curve, we create a ggplot base layer that has an x-axis range from -4 to 4 (or whatever range you want!), and assign the x-value aesthetic to this range (<code>aes(x = x)</code>). We then add the <code>stat_function</code> option and add <code>dnorm</code> to the function argument to make it a normal&nbsp;curve.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span> <span class="m">4</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_1-1.png" title="plot of chunk function_1" alt="plot of chunk function_1" style="display: block; margin: auto;" /></p>
<h3>Basic t-&nbsp;curve</h3>
<p><code>stat_function</code> can draw a range of continuous <a href="https://en.wikipedia.org/wiki/Probability_density_function">probability density functions</a>, including t (<code>dt</code>), F (<code>df</code>) and Chi-square (<code>dchisq</code>) PDFs. Here we will plot a t-distribution. As the shape of the t-distribution changes depending on the sample size (indicated by the degrees of freedom, or df), we need to specify our df value as part of defining our&nbsp;curve.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span> <span class="m">4</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dt</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="m">8</span><span class="p">))</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_2-1.png" title="plot of chunk function_2" alt="plot of chunk function_2" style="display: block; margin: auto;" /></p>
<h3>Plotting your own&nbsp;function</h3>
<p>You can also draw your own function, as long as it takes the form of a formula that converts an x-value into a y-value. Here we have plotted a curve that returns y-values that are the cube of x times a&nbsp;half:</p>
<div class="highlight"><pre><span></span><span class="n">cubeFun</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">x^3</span> <span class="o">*</span> <span class="m">0.5</span>
<span class="p">}</span>

<span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span> <span class="m">4</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">cubeFun</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_3-1.png" title="plot of chunk function_3" alt="plot of chunk function_3" style="display: block; margin: auto;" /></p>
<h3>Plotting multiple functions on the same&nbsp;graph</h3>
<p>You can plot multiple functions on the same graph by simply adding another <code>stat_function()</code> for each curve. Here we have plotted two normal curves on the same graph, one with a mean of 0.2 and a standard deviation of 0.1, and one with a mean of 0.7 and a standard deviation of 0.05. (Note that the <code>dnorm</code> function has a default mean of 0 and a default standard deviation of 1, which is why we didn&#8217;t need to explicitly define them in the first normal curve we plotted above.) You can also see we&#8217;ve changed the range of the x-axis to between 0 and&nbsp;1.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">))</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_4-1.png" title="plot of chunk function_4" alt="plot of chunk function_4" style="display: block; margin: auto;" /></p>
<h3>Customising axis&nbsp;labels</h3>
<p>Let&#8217;s move forward with this two function graph, and start tweaking the appearance. In order to change the axis labels, we have a couple of options. In this case, we have used the <code>scale_x_continuous</code> and <code>scale_y_continuous</code> options, as these have further customisation options for the axes we will use below. In each, we add the desired name to the <code>name</code> argument as a&nbsp;string.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="n">p9</span> <span class="o">+</span> <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_5-1.png" title="plot of chunk function_5" alt="plot of chunk function_5" style="display: block; margin: auto;" /></p>
<h3>Changing axis&nbsp;ticks</h3>
<p>The next thing we will change is the axis ticks. Let&#8217;s make the x-axis ticks appear at every 0.2 units rather than 0.25 using the <code>breaks = seq(0, 1, 0.2)</code> argument in <code>scale_x_continuous</code>. (The <code>seq</code> function is a base R function that indicates the start and endpoints and the units to increment by respectively. See <code>help(seq)</code> for more information.) We ensure that the x-axis begins and ends where we want by also adding the argument <code>limits = c(0, 1)</code> to <code>scale_x_continuous</code>.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="n">p9</span> <span class="o">+</span> <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_6-1.png" title="plot of chunk function_6" alt="plot of chunk function_6" style="display: block; margin: auto;" /></p>
<h3>Adding a&nbsp;title</h3>
<p>To add a title, we include the option <code>ggtitle</code> and include the name of the graph as a string&nbsp;argument.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="n">p9</span> <span class="o">+</span> <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_7-1.png" title="plot of chunk function_7" alt="plot of chunk function_7" style="display: block; margin: auto;" /></p>
<h3>Changing the colour of the&nbsp;curves</h3>
<p>To change the line colours of the curves, we add a valid colour to the <code>colour</code> arguments in <code>stat_function</code>. A list of valid colours is <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">here</a>.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;deeppink&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;dodgerblue3&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_8-1.png" title="plot of chunk function_8" alt="plot of chunk function_8" style="display: block; margin: auto;" /></p>
<p>If you want to go beyond the options in the list above, you can also specify exact <span class="caps">HEX</span> colours by including them as a string preceded by a hash, e.g., &#8220;#<span class="caps">FFFFFF</span>&#8221;. Below, we have called two shades of blue for the lines using their <span class="caps">HEX</span>&nbsp;codes.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;#4271AE&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;#1F3552&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_9-1.png" title="plot of chunk function_9" alt="plot of chunk function_9" style="display: block; margin: auto;" /></p>
<h3>Adding a&nbsp;legend</h3>
<p>As we have added two separate commands to plot the two function curves, ggplot does not automatically recognise that it needs to create a legend. We can make a legend by swapping out the <code>colour</code> argument in each of the <code>stat_function</code> commands for <code>aes(colour = )</code>, and assigning it the name of the group. We also need to add the <code>scale_colour_manual</code> command to make the legend appear, and also assign colours and a&nbsp;title.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 1&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 2&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_colour_manual</span><span class="p">(</span><span class="s">&quot;Groups&quot;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;deeppink&quot;</span><span class="p">,</span> <span class="s">&quot;dodgerblue3&quot;</span><span class="p">))</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_10-1.png" title="plot of chunk function_10" alt="plot of chunk function_10" style="display: block; margin: auto;" /></p>
<p>If you want to use one of the automatic brewer palettes, you can swap <code>scale_colour_manual</code> for <code>scale_colour_brewer</code>, and call your favouite brewer colour scheme. You can see all of the brewer palettes using <code>display.brewer.all(5)</code> As this command doesn&#8217;t allow you to assign a title to the legend, you can assign a title using <code>labs(colour = "Groups")</code>.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 1&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 2&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_colour_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s">&quot;Accent&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Groups&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_11-1.png" title="plot of chunk function_11" alt="plot of chunk function_11" style="display: block; margin: auto;" /></p>
<h3>Changing the size of the&nbsp;lines</h3>
<p>As you can see, the lines are a little difficult to see. You can make them thicker (or thinner) using the argument <code>size</code> argument within <code>stat_function</code>. Here we have changed the thickness of each line to size&nbsp;2.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 1&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 2&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_colour_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s">&quot;Accent&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Groups&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_12-1.png" title="plot of chunk function_12" alt="plot of chunk function_12" style="display: block; margin: auto;" /></p>
<h3>Using the white&nbsp;theme</h3>
<p>As explained in the previous posts, we can also change the overall look of the plot using themes. We&#8217;ll start using a simple theme customisation by adding <code>theme_bw()</code> after <code>ggplot()</code>. As you can see, we can further tweak the graph using the <code>theme</code> option, which we&#8217;ve used so far to change the&nbsp;legend.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="n">p9</span> <span class="o">+</span> <span class="nf">theme_bw</span><span class="p">()</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_13-1.png" title="plot of chunk function_13" alt="plot of chunk function_13" style="display: block; margin: auto;" /></p>
<h3>Creating an <span class="caps">XKCD</span> style&nbsp;chart</h3>
<p>Of course, you may want to create your own themes as well. <code>ggplot2</code> allows for a very high degree of customisation, including allowing you to use imported fonts. Below is an example of a theme Mauricio was able to create which mimics the visual style of <a href="http://xkcd.com/"><span class="caps">XKCD</span></a>. In order to create this chart, you first need to import the <span class="caps">XKCD</span> font, install it on your machine and load it into R using the <code>extrafont</code> package.
These instructions are taken from <a href="https://www.google.com.au/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0ahUKEwiWzafchdPJAhVBpJQKHe_LDT8QFggbMAA&amp;url=https%3A%2F%2Fcran.r-project.org%2Fweb%2Fpackages%2Fxkcd%2Fvignettes%2Fxkcd-intro.pdf&amp;usg=AFQjCNE-KciGY14e-Q1buYIVmTFC0ht__Q&amp;sig2=DZUwkvIHwfNWtTtkcz94jg">here</a>:</p>
<div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">extrafont</span><span class="p">)</span>

<span class="nf">download.file</span><span class="p">(</span><span class="s">&quot;http://simonsoftware.se/other/xkcd.ttf&quot;</span><span class="p">,</span>
              <span class="n">dest</span><span class="o">=</span><span class="s">&quot;xkcd.ttf&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&quot;wb&quot;</span><span class="p">)</span>
<span class="nf">system</span><span class="p">(</span><span class="s">&quot;mkdir ~/.fonts&quot;</span><span class="p">)</span>
<span class="nf">system</span><span class="p">(</span><span class="s">&quot;cp xkcd.ttf  ~/.fonts&quot;</span><span class="p">)</span>
<span class="nf">font_import</span><span class="p">(</span><span class="n">paths</span> <span class="o">=</span> <span class="s">&quot;~/.fonts&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s">&quot;[X/x]kcd&quot;</span><span class="p">)</span>
<span class="nf">fonts</span><span class="p">()</span>
<span class="nf">loadfonts</span><span class="p">()</span>
</pre></div>


<p>You can then create your&nbsp;graph:</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 1&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 2&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_colour_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s">&quot;Set1&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Groups&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">axis.line</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.major</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.grid.minor</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.border</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">&quot;xkcd-Regular&quot;</span><span class="p">),</span>
              <span class="n">text</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">16</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">&quot;xkcd-Regular&quot;</span><span class="p">),</span>
              <span class="n">axis.text.x</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">))</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_14-1.png" title="plot of chunk function_14" alt="plot of chunk function_14" style="display: block; margin: auto;" /></p>
<h3>Using &#8216;The Economist&#8217;&nbsp;theme</h3>
<p>There are a wider range of pre-built themes available as part of the <code>ggthemes</code> package (more information on these <a href="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html">here</a>). Below we&#8217;ve applied <code>theme_economist()</code>, which approximates graphs in the Economist&nbsp;magazine.</p>
<div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggthemes</span><span class="p">)</span>

<span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 1&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 2&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_colour_manual</span><span class="p">(</span><span class="s">&quot;Groups&quot;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;#4271AE&quot;</span><span class="p">,</span> <span class="s">&quot;#1F3552&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">theme_economist</span><span class="p">()</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">legend.direction</span> <span class="o">=</span> <span class="s">&quot;horizontal&quot;</span><span class="p">,</span>
              <span class="n">legend.box</span> <span class="o">=</span> <span class="s">&quot;horizontal&quot;</span><span class="p">,</span>
              <span class="n">legend.key.size</span> <span class="o">=</span> <span class="nf">unit</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="s">&quot;cm&quot;</span><span class="p">),</span>
              <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&quot;Tahoma&quot;</span><span class="p">),</span>
              <span class="n">text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="s">&quot;Tahoma&quot;</span><span class="p">),</span>
              <span class="n">axis.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
              <span class="n">legend.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">),</span>
              <span class="n">legend.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span> <span class="o">=</span> <span class="s">&quot;bold&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">))</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_15-1.png" title="plot of chunk function_15" alt="plot of chunk function_15" style="display: block; margin: auto;" /></p>
<h3>Creating your own&nbsp;theme</h3>
<p>As before, you can modify your plots a lot as <code>ggplot2</code> allows many customisations. Here is a custom plot where we have modified the axes, background and&nbsp;font.</p>
<div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

<span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 1&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 2&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_colour_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s">&quot;Accent&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Groups&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">axis.line</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.major</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;#d3d3d3&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.minor</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.border</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span> <span class="n">panel.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">14</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="s">&quot;Tahoma&quot;</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">&quot;bold&quot;</span><span class="p">),</span>
              <span class="n">text</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&quot;Tahoma&quot;</span><span class="p">),</span>
              <span class="n">axis.text.x</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">),</span>
              <span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">))</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_16-1.png" title="plot of chunk function_16" alt="plot of chunk function_16" style="display: block; margin: auto;" /></p>
<h3>Adding areas under the&nbsp;curve</h3>
<p>If we want to shade an area under the curve, we can do so by creating a function that generates a range of normal values with a given mean and standard deviation, and then only retains those values that lie within the desired range (by assigning NAs to everything outside of the range). In this case, we have created a shaded area under the group 1 curve which covers between the mean and 4 standard deviations above the mean (as given by <code>0.2 + 4 * 0.1</code>). We then add another <code>stat_function</code> command to the graph which plots the area specified by this function, indicates it should be an <code>area</code> plot, and makes it semi-transparent using the <code>alpha</code> argument.</p>
<div class="highlight"><pre><span></span><span class="n">funcShaded</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">)</span>
    <span class="n">y[x</span> <span class="o">&lt;</span> <span class="m">0.2</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="p">(</span><span class="m">0.2</span> <span class="o">+</span> <span class="m">4</span> <span class="o">*</span> <span class="m">0.1</span><span class="p">)</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="kc">NA</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">p9</span> <span class="o">&lt;-</span> <span class="n">p9</span> <span class="o">+</span> <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">funcShaded</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s">&quot;area&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s">&quot;#84CA72&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_17-1.png" title="plot of chunk function_17" alt="plot of chunk function_17" style="display: block; margin: auto;" /></p>
<h3>Formatting the&nbsp;legend</h3>
<p>Finally, we can format the legend by changing the position. We simply add the <code>legend.position = "bottom"</code> argument to the <code>theme</code> option, which moves the legend under the&nbsp;plot.</p>
<div class="highlight"><pre><span></span><span class="n">p9</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.1</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 1&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span> <span class="o">=</span> <span class="n">dnorm</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
                      <span class="nf">aes</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Group 2&quot;</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">funcShaded</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s">&quot;area&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s">&quot;#84CA72&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Probability&quot;</span><span class="p">,</span>
                              <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span>
                              <span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal function curves of probabilities&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">scale_colour_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s">&quot;Accent&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">labs</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;Groups&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
        <span class="nf">theme</span><span class="p">(</span><span class="n">axis.line</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.major</span> <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;#d3d3d3&quot;</span><span class="p">),</span>
              <span class="n">panel.grid.minor</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">panel.border</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span> <span class="n">panel.background</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
              <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">14</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="s">&quot;Tahoma&quot;</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">&quot;bold&quot;</span><span class="p">),</span>
              <span class="n">text</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&quot;Tahoma&quot;</span><span class="p">),</span>
              <span class="n">axis.text.x</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">),</span>
              <span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">9</span><span class="p">),</span>
              <span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;bottom&quot;</span><span class="p">)</span>
<span class="n">p9</span>
</pre></div>


<p><img src="/figure/function_18-1.png" title="plot of chunk function_18" alt="plot of chunk function_18" style="display: block; margin: auto;" /></p>
        <hr class="divider-short"/>
        <!-- Disqus goes here -->
        <!-- <section>
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite">Disqus goes here</div>
        </section>
        -->
      </div>
    </div>
  </div>
</article>
    <footer id="footer" class="her-row">
      <div class="container">
        <div class="row">
          <div class="col-md-1">
            <a href="/"><h4>Home</h4></a>
          </div>

          <div class="col-md-2">
            <div class="social-icon-list">
              <a href="https://twitter.com/t_redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_31_twitter.png"
              /></a>
               <a href="https://github.com/t-redactyl"
                ><img
                  src="https://t-redactyl.github.io/theme/images/glyphicons_social_21_github.png"
              /></a>
              </div>
          </div>
          <div class="pull-right">
            <h4>
              Powered by <a href="http://blog.getpelican.com/">Pelican</a>.
              Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.
              Title picture by
              <a
                href="https://pixabay.com/en/brandenburg-gate-berlin-landmark-2010656/"
                >Couleur via Pixabay</a
              >.
            </h4>
          </div>
        </div>
      </div>
    </footer>

    <!-- KaTeX rendering -->
    <script>
      renderMathInElement(document.body);
    </script>

 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66946155-1', 'auto');
  ga('send', 'pageview');

</script>    </body>
</html>